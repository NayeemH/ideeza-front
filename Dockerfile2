FROM node:lts

RUN mkdir /app
COPY . /app/
WORKDIR /app/
RUN mv '.env' .env.local
RUN sed -i '2d' .env.local
RUN echo "NEXTAUTH_URL=https://dev.ideeza.com" >> .env.local
RUN npm cache verify
RUN npm cache clear --force
RUN NODE_OPTIONS="--max_old_space_size=4096" npm install --legacy-peer-deps && npm run build
ENTRYPOINT npm start

